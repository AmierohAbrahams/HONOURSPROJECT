---
title: "Complete"
author: "Amieroh Abrahams"
date: "11 August 2018"
output: html_document
---
\newpage
## Plagiarism Declaration

\newpage
## Declaration


\newpage
## Abstract

\newpage
## Acknowledgments

Special thanks go to my supervisor, AJ Smit, for the continuous motivation and guidance throughout my honours year. All of your contributions and efforts towards my academic career and experiences have been appreciated beyond measure. I would also like to thank Dr. Robert Schlegel and my co-supervisor, Dr. Robert Williamson for the help with my R analyses. I would like to thank KZNSB, DEA, DAFF, SAEON, SAWS, UWC and EKZNW for contributing the raw data allowing me to do this study. Without the data this thesis would not be possible.I would also like to thank my colleagues within Team Kelp who assisted me throughout this project. Their discussions and friendship has largely aided in the completion of this thesis. To my friends and family, thank you for providing me with the necessary support and encouragement. I would also like to acknowledge the entire Biodiversity and Conservation biology department at the University of the Western Cape. Lastly, i would like to thank the NRF for providing the necessary funding towards the completion of this project.

\newpage
# Introduction

Temperature is the main determinant of biogeographical patterns and ecosystem processes, having observable effects on an organism’s survival and reproductive patterns (Smit et al. 2013; Pearce et al. 2006; Smale and Wernberg, 2009). The temperatures of seawater are a key indicator of environmental changes in marine ecosystems (Pearce et al. 2006). Despite the controlling effects that temperature plays on the growth, survival, and distribution of marine organisms, little is known regarding temperatures within coastal zones. Within coastal zones, seawater temperature varies as it is affected by a range of nearshore processes such as wave action, winds, tides, and turbidity. Additionally, the thermal properties of the substratum may also affect temperature variation (Smale and Wernberg 2009), allowing for a large range in variation at a localized scale. Given the significance of the impacts of temperature, it is imperative to understand how marine organisms may respond to temperature variation at coastal regions on both a global and local scale.

The coastal region of South Africa, spanning approximately 3113 km in length (Smit et al. 2013), has not yet been studied in great detail at highly localized scales. Upon looking on a broad scale, this region exhibits a large variation in seawater temperatures across its coastline (Mead et al. 2013; Smit et al. 2013) and is divided into three distinct coastal regions, each with contrasting temperatures. These include the cold temperate west coast, warm temperate south coast, and the subtropical east coast. These regions display noticeable differences in seawater temperatures in comparison to each other, primarily due to the influences of the neighbouring ocean currents (Bolton et al. 2004; Mead et al. 2013; Schlegel and Smit 2016).

The South African coastline is bordered by the Benguela and Agulhas Currents on the west and east coasts respectively. The Benguela Current assists in transporting cold water northwards from the Southern Ocean (Hutchings et al. 2009; Schlegel et al. 2017), whereas the Agulhas, western boundary current, transports sub-tropical, warm water towards the tip of Africa (Smit et al. 2017). Together these two currents are responsible for the presence of a strong West-East thermal gradient occurring along the coastline of South Africa, with the west coast having significantly colder waters than the east coast. (Smit et al. 2013). The south coast is unique as it affected by both the Benguela and Agulhas currents. In this way, the south coast region differs from the other two coastal regions as it experiences greater variations within its localized thermal gradient due to the influences of two contrasting ocean currents (Lutjeharms and Ballegooyen 1988). These currents can vary up to as much as 10°C (Schlegel et al 2017) within a 24-hour period thus creating fluctuations in seawater temperatures around the Western Cape region. The Agulhas Current is driven by a wind stress curl between the southeast trade winds and the Southern Hemisphere westerlies (Beal et al. 2011). The Agulhas current retroreflects after making contact with the Benguela current and may often interact with the South Atlantic ( Hutchings et al., 2009), resulting in warm Indian Ocean water moving into the Atlantic at depths exceeding 2000m (Beal et al., 2011; Schlegel et al. 2017). These currents strongly affect the seawater temperatures around South Africa, and recent studies have shown that the temperatures have been changing. 

The statistical properties such as the mean, minimum, and maximum temperatures of *in situ* coastal seawater temperature time series representing the entire South African coastline, shows distinct coastal variations as a result of the Agulhas and Benguela currents (Schlegel and Smit 2016). Due to the small range of ambient temperatures experienced on the West coast, fluctuations are able to occur over a short period of time. Research has found that the seawater temperatures of the Benguela Current has been decreasing at a rate of approximately 0.5 °C per decade whilst the Agulhas Current has been increasing by between 0.55 °C - 0.7 °C per decade (Rouault et al. 2009; 2010). Overall, sea surface temperatures (SST) around South Africa have increased by approximately 0.25 °C between 1903 and 2013 (DEA, 2013) and are still increasing at a rate of 0.12 °C per decade (Schlegel and Smit, pers. comm.). The exact causes of these changes are not fully understood, however human activities are known to influence on coastal seawater temperature (Rouault et al. 2009; 2010).

Due to their close proximity to populated or infrastructural areas, coastal regions are more accessible to humans in comparison to fully marine and open ocean regions. As a result, these areas are more susceptible to changes on both temporal and spatial scales(Help et al 2011; Kennish and Elliot 2011; Sink et al. 2012; Mead et al 2013). Along the South African coastline, direct pressures include exploitation of coastal resources, pollution and modification of communities (Griffiths et al 2004; Sink et al. 2012; Mead et al 2013). These changes may directly be influenced by anthropogenic activity and hence promote climate change which ultimately influences air temperature, wind and sea surface temperature (Mead and Robinson 2011; Rouault and Mead 2011; Mead et al 2013).

Over the last few decades, improvements in remote sensing technology have enabled researchers to map global sea surface temperature with a high level of accuracy (Zainuddin et al. 2006; Smale and Wernberg 2009). The National Oceanic and Atmospheric Administration’s (NOAA) series of satellites have provided global SST datasets from the 1980s on both global and local scales (Pearce et al. 2005). The NOAA dataset is critically important as satellite temperature datasets are often used to monitor changes in oceanic temperatures and provide valuable information on both biological and physical parameters in the ocean (Demarcq et al. 2010). Furthermore, satellite-derived SST data plays an important role in the creating projections predicting the potential effects of climate change on coastal and oceanic marine biota (Muller et al. 2009; Hilbish at al. 2011; Bartsch et al. 2012). Satellite-derived data is not as reliable as *in situ* temperature measurements, but are often used as a proxy when these measurements are scares or unavailable (Smale and Wernberg 2009). 

Satellite-derived temperature measurements often differ from *in situ* measurements (Katsaros 2003; Castillo and Lima 2010). This is primarily due to coastal satellite measurements failing to record small-scale variability or providing realistic information on average climatological temperatures. Smit et al. (2013) has shown that within offshore environments, satellite data generally reflects reality and has been validated against *in situ* measurements. Along coastal regions however, it was found that satellite-derived data had a warm bias of 6 °C when compared to coastal *in situ* collected seawater temperature data. For study sites located within a 400 m distance of the shoreline, it is recommended that data collected *in situ* be used over satellite-derived temperatures where possible (Smit et al. 2013).

Developments of *in situ* collected coastal temperature data products over the last three decades provide a more reliable source of accurate coastal seawater temperature data (Smit et al. 2013). The South African Coastal Temperature Network (SACTN) has collected SST data for the South African coastline from as early as 1972, with contributions from various organisations and governmental departments. This data was obtained via a combination of different instruments and methods, including hand held alcohol thermometers and underwater temperature recorders, and as a result of this inconsistency, the coastal seawater temperature data has been recorded at differing levels of precision (0.5°C and 0.001°C respectively) but are likely more reliable than satellite derived data.

It is important to understand the characteristics of the data sources which aid in yielding accurate and reliable measurements when comparing temperature variation along the coast. This led to the examination of the 129 *in situ* collected sites which makes up the SACTN dataset. The length of the time series and statistical characteristics of the dataset were used to guide a series of analysis. The length of the time series for each of the sites were adjusted systematically hence forming the core of the analysis. The variation of each of the time series differ as expected, by the Agulhas and Benguela Currents. The purpose of this study was to examine variations in temperature between selected sites along the South African coastline using seawater temperature data to better understand patterns of coastal temperature at a localized scale. Additionally, this study also examined the influence of environmental factors, namely, wave and wind action on coastal seawater temperatures. The aims of this study were to: i) examine whether there is homogeneity between the various sites sampled, ii) examine whether or not wind and wave action may cause a variation in seawater temperatures along the South African coastline and iii) to examine whether the different instruments used in data collection varied in regards to the temperature values at the same sites.

\newpage
# Methods

In order to compare abiotic parameters such as wind and wave action along the South African coastline,vast historical datasets for temperature, wave and wind were analysed and accessed. 

## Wave and wind data

Wind and wave action were important variables in this study as they are predicted to exhibit a direct influence on coastal water temperatures, and were used to investigate the impact of abiotic parameters on seawater temperature at specific sites along the South African coastline. Wind and wave data was obtained from the South African Weather Service (SAWS), and were presented at three hour resolutions. The data was then used to model short–crested waves, generated by the wind into the coastal environment, using Simulating Waves in the Nearshore (SWAN). SWAN enables the extraction of wave parameters from specific gridded locations in the nearshore. A resolution of 200 meters was modelled, at both 7 and 15 meter contours.

## Temperature data

In order to measure variation in temperature across sites, the SACTN dataset was the primary source of temperature data. This dataset consisted of coastal seawater temperatures for 129 sites along the coast of South Africa, measured daily from 1972 until 2017. Of these, 80 were measured using hand-held thermometers and the remaining 45 were measured using underwater temperature recorders (UTRs).  Data collected predominately along the east coast of South Africa was obtained using glass thermometers from boats at the shark net locations along the coastline at a precision of 0.1 °C.

The SACTN dataset time series commenced from 1 January 1972 in Knysna, extending up to 20 December 2017 in Port Nolloth. Recordings per site were uneven, with the longest time series in the dataset being that of Gordons Bay, recorded by SAWS. Data collected for this region started on 13 September 1972 and concluded on 26 January 2017, with recordings still continuing daily. During the 1970s, a total of 11 time series began recording. A further 53 entries were added during the 1980s, 34 entries were added during the 1990s, and 18 entries were added during the 2000s. Recordings are still ongoing at several of these sites.

Seven sources contributed towards the compilation of this dataset: The Department of Environmental Affairs (DEA), South African Weather Services (SAWS), University of the Western Cape (UWC), Department of Forestry and Fisheries (DAFF), Kwa Zulu Natal Sharks Board (KZNSB), South African Environmental Observation Network (SAEON) and Ezemvelo KZN Wildlife Organization (EKZNW). KZNSB and SAWS made use of hand-held alcohol thermometers, taking measurements 20 cm below the sea surface. Temperature measurements taken with underwater temperature recorders, collected by DEA varied between a range of 0-28m, measurements obtained by DAFF varied between ranges of 0-9m, those collected by EKZN varied between ranges of 10-14m. SAEON and UWC placed the UTRs at depths of 0m and 0-6m respectively. Electronic instruments used for seawater temperature recordings have improved over the past four decades. Previous UTRs collected seawater temperature at a precision of 0.01°C whereas current models collect temperature at a thermal precision of 0.001°C. Data recorded using thermometers are saved and extracted annually.

## Data storage

Data collection protocols varied amongst the seven sources contributing to the SATCN dataset.  As a result, the data was not uniformly formatted. For these analyses, the data was combined and all temperature data were formatted into standardized comma delineated values (CSV) which allowed for a fixed methodology to be used across the entire dataset, thereby improving accuracy. Prior to data analysis, all data points exceeding 35 °C and/or below 0 °C were removed as these were  considered as outliers. These data points were then changed to NA (not available) so as to not interfere with analysis. All analyses performed in this thesis were conducted in R software version 3.4.2.

## Satellite derived SST data

This study made use of four satellite derived SST datasets in comparison with the SACTN *in situ* derived coastal seawater temperature dataset. The AVHRR- Only Optimum Interpolated Sea Surface Temperature (OISST) was used to determine SST within the study region. The AVHRR datasets have provided global SST’s for more than three decades (Reynolds and Smith, 1994; Pearce et al 2006). OISST is a global 1/4 ◦ gridded daily SST product that assimilates both remotely sensed and *in situ* sources of data to create a level-4 gap free product (Banzon et al., 2016; Schlegel et al., 2017). The Multi-scale Ultra-high Resolution (MUR) Sea Surface Temperature Analysis, the second dataset, has been observed using satellite instruments with datasets spanning from 1st June 2002 to present times. MUR provides SST data at a spatial resolution of 0.01 degrees in longitude-latitude coordinates, at 1 km intervals; and is currently among the highest resolution SST available. The third dataset, a Group for High Resolution Sea Surface Temperature (GHRSST) Level 4 sea surface temperature analysis, known as the K10 dataset, is produced at the Naval Oceanographic Office (NAVOCEANO) on a 0.1 degree grid, globally. This analysis makes use of SST observations from the AVHRR, the Geostationary Operational Environmental Satellite (GOES) Imager and the Advanced Microwave Scanning Radiometer for EOS (AMSR-E). The CMC dataset constitutes the forth dataset and is a version 3.0 Group for High Resolution Sea Surface Temperature (GHRSST) Level 4 dataset with a 0.1 degree spatial resolution constructed by the Canadian Meteorological Center (CMC). This young dataset is available from the 1st January 2016. The CMC dataset combined infrared satellite SST at numerous points in the time series from the AVHRR, the European Meteorological Operational-A (METOP-A) and Operational-B (METOP-B) platforms, and microwave SST data from the Advanced Microwave Scanning Radiometer 2 in conjunction with *in situ* observations of SST from ships and buoys from the ICOADS program. For the statistical interpolation used to assimilate the satellite and *in situ* observations, the CMC incorporated the previous days’ analysis as the background field.

## Site selection

In order to compare temperatures along the South African coastline at a localized scale, appropriate sites from each of the major coastal regions needed to be selected. Since temperature data was not evenly recorded for each of the 129 sites representing South Africa’s coastline, the first step was to narrow down available sites that could be adequately compared. To do this a clustering analysis was perfomed using the `kmeans` function in R software with multiple random seeds to identify a number of clustering solutions that grouped sites together based on their available temperature data. The mean, minimum, and maximum temperature values were used within the clustering to group sites with similar temperatures along each coastal region. The clustering analysis represented the most accurate and distinct site groupings based on temperature distributions and yielded distinct east, south, and west coast groupings. Six clustering solutions along the South African coastline were also shown (Figure 1). With the data now divided into six distinct coastal regions, a time series was selected of at least one decade of data for each of the sites, excluding those with temperature data collected deeper than five meters. The length, decadal trend and precision of the time series were adjusted in a systematic manner to allow for meaningful comparisons to be made.
 
```{r}
## Libraries
library(tidyverse)
library(viridis)
library(gridExtra)

load("data/southern_africa_coast.Rdata")
load("data/africa_coast.RData")
load("data/sa_provinces_new.RData")
load("data/sa_coast.Rdata")

clust_i <- function(i) {
  set.seed(10)
ggplot(data = southern_africa_coast, aes(x = long, y = lat)) +
  geom_polygon(aes(group = group), fill = "grey70") +
    borders() +
    geom_point(data = site_list,
         aes(x = lon, y = lat,
             colour = as.factor(kmeans(clust_columns, i)$cluster))) +
    labs(colour = "cluster")  +
    coord_equal(xlim = c(15, 35), ylim = c(-37, -27)) +
  annotate("text", label = "INDIAN\nOCEAN", x = 32.00, y = -34.0, size = 3.0, angle = 0, colour = "black") +
  annotate("text", label = "ATLANTIC\nOCEAN", x = 16.00, y = -34.0, size = 3.0, angle = 0, colour = "black") +
  geom_segment(aes(x = 17.2, y = -32.6, xend = 15.2, yend = -29.5),
                arrow = arrow(length = unit(0.3, "cm")), size = 0.1, colour = "black") +
    annotate("text", label = "Benguela", x = 16.0, y = -31.8, size = 3.5, angle = 298, colour = "black") +
    geom_segment(aes(x = 33, y = -29.5, xend = 29.8, yend = -33.0),
                arrow = arrow(length = unit(0.3, "cm")), size = 0.1, colour = "black") +
    annotate("text", label = "Agulhas", x = 31.7, y = -31.7, size = 3.5, angle = 53, colour = "black") +
  scale_x_continuous(breaks = seq(15, 35, 5),
                       labels = scales::unit_format("°E", sep = ""),
                       position = "bottom") +
    scale_y_continuous(breaks = seq(-35, -30, 5),
                       labels = c("35°S", "30°S")) +
    labs(x = NULL, y = NULL) +
    coord_cartesian(xlim = c(10.5, 39.5), ylim = c(-39.5, -25.5), expand = F) +
  scaleBar(lon = 32.0, lat = -38.7, distanceLon = 200, distanceLat = 50, 
           distanceLegend = 90, dist.unit = "km", arrow.length = 100,
           arrow.distance = 130, arrow.North.size = 3) +
  theme_bw() +
    theme(panel.border = element_rect(fill = NA, colour = "black", size = 1),
          axis.text = element_text(colour = "black"),
          axis.ticks = element_line(colour = "black"))
}

clust_6 <- clust_i(6)
clust_6

africa_map <- ggplot(africa_coast, aes(x = lon, y = lat)) + 
  theme_bw() + 
  coord_equal() + 
  geom_polygon(aes(group = group), colour = "black", fill = "grey80") + 
  geom_polygon(data = sa_provinces_new, (aes(group = group))) +
  annotate("text", label = "Africa", x = 16.0, y = 15.0, size = 3) + 
  theme(panel.border = element_rect(colour = "black", size = 0.4), 
        plot.background = element_blank(), 
        axis.ticks = element_blank(), 
        axis.text = element_blank(), 
        axis.title = element_blank(), 
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
  coord_map(xlim = c(-20, 53), ylim = c(-36, 38), projection = "mercator") 
africa_map

# png(file="mrdq.png",w=1800,h=1800, res=300)
# grid.newpage()
# v1<-viewport(width = 1, height = 1, x = 0.5, y = 0.5) #plot area for the main map
# v2<-viewport(width = 0.3, height = 0.3, x = 0.86, y = 0.28) #plot area for the inset map
# print(clust_6,vp=v1) 
# print(africa_map,vp=v2)
# dev.off()

# More mapping - http://r-nold.blogspot.com/2014/06/creating-inset-map-with-ggplot2.html

pdf("figures/map_complete.pdf", width = 8, height = 5, pointsize = 6) # Set PDF dimensions
vp1 <- viewport(x = -0.00, y = 0.05, w = 0.25, h = 0.25, just = c("left", "bottom")) # Africa
vp2 <- viewport(x = 1.0, y = 1.0, w = 1.00, h = 1.00, just = c("right", "top"))  # South Africa
print(clust_6, vp = vp2)
print(africa_map, vp = vp1)
dev.off()
```

Once sites were grouped together, the next step was to reduce the number of sites down to a manageable, but still representative, sub-sample of the whole. This was done primarily for two reasons. The first, simply, was to allow for the comparisons to be more readily interpretable by humans.  Secondly it was to allow for equal amount of sampling per coast. The east coast has previously been more heavily sampled than the rest and such an imbalance should be addressed. The criteria considered for the sub-samples included selecting the longest time series within the  region and including data from as many different organizations as possible. This process yielded three sites for each of the clusters along the South African coastline (Figure 2). The statistical characteristics of the temperature were used to guide analysis of the time series to produce an accurate assessment of temperature variation between sites that were grouped together.

```{r load_files3, include=TRUE}
load("Mapping/sa_provinces.RData")
load("Mapping/south_africa_coast.RData")
```

```{r define_fun2, include=TRUE}
site_coordinates1 <- filter(site_list_sub, cluster == 1) %>% 
  select(site, lon, lat)

site_coordinates2 <- filter(site_list_sub, cluster == 2) %>% 
  select(site, lon, lat)

site_coordinates3 <- filter(site_list_sub, cluster == 3) %>% 
   select(site, lon, lat)

site_coordinates4 <- filter(site_list_sub, cluster == 4) %>% 
  select(site, lon, lat)

site_coordinates5 <- filter(site_list_sub, cluster == 5) %>% 
  select(site, lon, lat)

site_coordinates6 <- filter(site_list_sub, cluster == 6) %>% 
  select(site, lon, lat)

mapping_plot <- function(df, xy = "salmon"){
  mapping <- df %>% 
ggplot(aes(x = lon, y = lat)) +
  geom_polygon(data = south_africa_coast, aes(group = group), fill = "grey70") +
  coord_cartesian(xlim = c(12, 36), ylim = c(-38, -26)) +
  geom_path(data = sa_provinces, aes(group = group)) +
  geom_point(data = df, colour = xy)  +
  geom_label_repel(data =df, aes(x = lon, y = lat, label = site), 
                   size = 3, box.padding = 2, nudge_x = -0.5, nudge_y = 0.2, 
                   segment.alpha = 0.4, force = 0.1) +
  coord_equal(xlim = c(15, 35), ylim = c(-37, -27)) +
  annotate("text", label = "INDIAN\nOCEAN", x = 35.00, y = -34.0, size = 3.0, angle = 0, colour = "black") +
  annotate("text", label = "ATLANTIC\nOCEAN", x = 12.00, y = -34.0, size = 3.0, angle = 0, colour = "black") +
  # geom_segment(aes(x = 17.2, y = -32.6, xend = 15.2, yend = -29.5),
  #               arrow = arrow(length = unit(0.3, "cm")), size = 0.1, colour = "black") +
  #   annotate("text", label = "Benguela", x = 14.0, y = -31.8, size = 3.5, angle = 298, colour = "black") +
  #   geom_segment(aes(x = 33, y = -29.5, xend = 29.8, yend = -33.0),
  #               arrow = arrow(length = unit(0.3, "cm")), size = 0.1, colour = "black") +
  #   annotate("text", label = "Agulhas", x = 31.7, y = -31.7, size = 3.5, angle = 53, colour = "black") +
  scale_x_continuous(breaks = seq(15, 35, 5),
                       labels = scales::unit_format("°E", sep = ""),
                       position = "bottom") +
    scale_y_continuous(breaks = seq(-35, -30, 5),
                       labels = c("35°S", "30°S")) +
    labs(x = NULL, y = NULL) +
    coord_cartesian(xlim = c(10.5, 39.5), ylim = c(-39.5, -25.5), expand = F) +
     scaleBar(lon = 32.0, lat = -38.7, distanceLon = 200, distanceLat = 50, 
           distanceLegend = 90, dist.unit = "km", arrow.length = 100,
           arrow.distance = 130, arrow.North.size = 3) +
  theme_bw() +
    theme(panel.border = element_rect(fill = NA, colour = "black", size = 1),
          axis.text = element_text(colour = "black"),
          axis.ticks = element_line(colour = "black"))
  return(mapping)
}
```

```{r run_fun2, include=TRUE}
map_clus1 <- mapping_plot(df = site_coordinates1, xy = "salmon")
map_clus2 <- mapping_plot(df = site_coordinates2, xy = "darkgoldenrod4")
map_clus3 <- mapping_plot(df = site_coordinates3, xy = "springgreen4")
map_clus4 <- mapping_plot(df = site_coordinates4, xy= "lightskyblue")
map_clus5 <- mapping_plot(df = site_coordinates5, xy= "steelblue3") 
map_clus6 <- mapping_plot(df = site_coordinates6, xy= "mediumorchid1") 

final_map_combined_A <- ggarrange(map_clus1, map_clus2, map_clus3, map_clus4, map_clus5, map_clus6,
          ncol = 2, nrow = 2)
final_map_combined_A
```

With three sites per cluster, the haversine formula was used to calculate the geodesic distance between points specified by radians. Using this formula, the distances (km) between each of the sites along the coastline were determined. Thereafter, sites within the same cluster were matched based on the date that temperature was collected. This allowed for a comparison to test whether or not temperature variation exists between sites within the same cluster. Once the sites were matched, the means and standard deviations of temperatures between sites and clusters were determined. This highlighted the temperature variation between matched sites and allowed for seasonal comparisons within the same cluster.

Once the temperature variation between sites were carefully analysed, the seawater temperature data along with the wave and wind data were compared. Since the wave and wind data were collected at three hour resolutions, they were converted into daily data points in order to compare it with the temperature data. The wave data was collected at depths of 7 m or 15 m respectively. The ‘circular’ function in R software was then used to create circular objects around the wave data in order to calculate the daily wave and wind direction.

With temperature and wave values now corresponding to their respective sites, depths and dates, the hypothesis regarding whether or not a relationship existed between wind/wave action and temperature was tested. To do this, linear models for each site was produced, reflecting temperature and wave variations at each depth. Linear models typically produce coefficients of determination R2 as an output, the ‘purrr’ function within the ‘tidyverse’ R package was used to simultaneously compare temperature and wave data across sites and depths. Hereafter, ind and wave rose diagrams were constructed to determine the most predominant direction for a particular site. This was done to ascertain what the potential relationship between wind/waves and temperature was at each site during only the prevailing wind/wave directions.

## Satellite data analysis

Sea Surface temperature measurements used in this study were obtained from four different sources: MUR, CMC, K10 and AVHRR. A time series of SST was determined by creating a bounding box which represented the region of extent at the latitudes (-39.5° S, -25.5° S), and the longitudes (10.5° E, 39.5° E). The size of the pixel search area was set to use 2x the resolution of the sensor and at least 5x resol(km) from each of the stations. The satellite datasets and the corresponding SACTN *in situ* collected dataset were matched based on the latitudes, longitudes and the date at which temperature was collected. Some sites however, shared the same satellite data due to their close proximities. Once the satellite data corresponded with the *in situ* collected data, linear models for each site were produced, reflecting temperature and wave variations at each depth. Linear models typically produce coefficients of determination (R2 values) as an output, which is the statistic showing how much of the variance in a dependent variable is explained by the independent variable.

## Statistical analyses

A series of ANOVA tests were used to compare the main effects of the chosen variables on a continuous variable. In this analysis the relationship between matched sites based on the year and season as a function of the mean temperature were analysed, these analyses were used to test if significant differences occured between each pair of sites within each of the clusters. To compare whether temperature variation exist between sites found within the same clusters along the coast, boxplots were constructed. These plots enabled the visual identification of variations in temperature.

## Results

```{r}
combined_plot <- ggarrange(SACTN_clust_1_plot1, SACTN_clust_2_plot1,
                           SACTN_clust_3_plot1, SACTN_clust_4_plot1, 
                           SACTN_clust_5_plot1, SACTN_clust_6_plot1)
combined_plot
```

Temperatures were not uniformly distributed across the six clusters produced, with each set of sites having unique patterns of temperature variation. In cluster 1, which includes Humburg, Eastern  Beach and Orient Beach, we found that temperature varied from approximately 13 ºC to 22  ºC. Within this cluster of sites, we found that Hamburg had the highest maximum temperatures and the lowest minimum temperatures between the three sites. Orient  Beach had the lowest range of temperature variability and it produced a comparatively short box plot. Orient Beach and Eastern Beach had relatively similar ranges and distributions of temperatures as evident by their box plots nearly overlapping completely. 

In the cluster comprising of Mossel Bay, Stilbaai and Knysna, temperatures ranged from approximately 12 ºC to 27 ºC, with most box plots being relatively long. Stilbaai had the widest range of temperature variation of the three sites. Despite the apparent differences in temperature ranges between these sites, the average temperatures across these were relatively similar and near completely identical, with very few outliers present within the temperatures of these sites.

Sites within the third cluster had slightly lower temperatures than the previous two clusters. This cluster comprise of Bordjies, Saldanha and Gansbaai, Temperatures within this cluster ranged from approximately 11 ºC to 21  ºC, with an average median temperature being close to 15  ºC across all three of the sites. Gansbaai had relatively low variation in temperature as it had a comparatively short box plot. Conversely, Saldanha had relatively long box plots representing high variation and relatively evenly distributed temperatures. These sites were relatively similar in terms of temperature variances, as their box plots were largely overlapping with few differences between them. There were however several outliers present within the temperatures of these sites.

The fourth cluster comprised of Port Edward, Leisure Bay and T.O. Strand. Overall, the temperatures of these sites were higher than those of the sites within the other clusters, with a range of between 15 ºC  to 25 ºC, which is considerably much higher than that of the others.  The box plots were all relatively long representing a low variation, and had very little skewness. Temperature did not differ between these three sites with each box plot overlapping very well. The median temperature for each of the sites within this cluster is 20.5  ºC. 

Sites within the fifth cluster had overall lower temperatures than those within the remaining clusters. This cluster comprised of Port Nolloth, Lamberts Bay and Sea Point, and here we found sharp declines in average temperatures throughout. The temperature range within this cluster was approximately 8 ºC to 18 ºC, with an average median temperature being close to 13 ºC. Port Nolloth had relatively low variation in temperature as it had a comparatively short box plot with relatively evenly distributed temperatures. Lamberts Bay and Sea Point were relatively similar in terms of temperature variances, as their box plots were largely overlapping with little differences between them. Several outliers are present within the temperatures of these sites.

In the cluster comprising of Kalk Bay, Muizenberg and Gordons Bay temperature ranged from  approximately 8 ºC to 24  ºC, with most box plots being relativley short. Muizenberg had the widest range of temperature variation of the three sites.  Gordons Bay and Kalk Bay, had identical temperature ranges. Despite the apparent differences in temperature ranges between these sites, the average temperatures across these were relatively similar and near completely identical.
****Still need to add in some things on the distances between sites***

```{r}
(SACTN_clust_1_plot2 <- clust_plot2(df = SACTN_clust_1_matched))
(SACTN_clust_2_plot2 <- clust_plot2(df = SACTN_clust_2_matched))
(SACTN_clust_3_plot2 <- clust_plot2(df = SACTN_clust_3_matched))
(SACTN_clust_4_plot2 <- clust_plot2(df = SACTN_clust_4_matched))
(SACTN_clust_5_plot2 <- clust_plot2(df = SACTN_clust_5_matched))
(SACTN_clust_6_plot2 <- clust_plot2(df = SACTN_clust_6_matched))
```

On a monthly basis, the differences of average temperatures between sites within cluster 1, Eastern Beach, Orient Beach and Humburg, we found a large average temperature variation between Hamburg and Eastern Beach during the summer and spring months of 1995 to 1997. For the remaining sites however differences in average temperatures were relativley low during Autumn. It was also evident that the average temperature between Hamburg and Orient Beach vary largely on an apparent seasonal basis. Slight average temperature variation existed between Eastern Beach and Orient Beach throughout the different seasons.

Converse to the first cluster, in the cluster containing, Mossel Bay, Knysna and Stilbaai, , the largest differences in average temperatures were observed during autumn and winter months.  In this cluster we saw large differences in average temperatures between Mossel Bay and Knysna, with the differences increasing annually from 1985 to 2017. Similarly differences in average temperature also  slightly increase between Stilbaai and Knysna during winter and spring. During summer months we see little differences in average temperature varation between all three sites within this cluster.

On a monthly basis, differences of average temperatures between sites within cluster 3 (Bordjies, Gansbaai and Saldanha) vary on an apparent seasonal basis. During the summer months we saw that there were large differences in average temperatures between Bordtjies and the remaining three sites, with an increase in differences of average temperature between Saldanha Bay and Gansbaai throughout autumn, winter and spring. Average temperature differences between Saldanha Bay and Gansbaai on a seasonal basis. 

In the fourth cluster, which was comprised of Port Edward, Leisure Bay and T.O. Strand, we found small changes in the differences of average temperatures between sites on a monthly basis between 1980 to 2017. ere, the biggest differences in temperatures were observed towards the end of spring and during summer months. Temperature were relativley stable throughout winter and the beginning  of sprinbg across all three sites found within this cluster.

In the cluster containing Lamberts Bay, Port Nolloth and Sea Point, we found large differences in average temperatures between sites at selected months between 1972 and 2017. During summer and Autumn months, differences in average temperature between Lamberts Bay and the remaining sites increased. During the months of autumn Lamberts Bay and Seapoint showed large differences in average temperature variation. For the remaining sites, differences in average temperatures were relatively low throughout each month for the same time period.

In the cluster comprising of Kalk Bay, Gordons Bay and Muizenberg, the largest differences in average temperatures were observed during mid autum and winter months. In this cluster we saw large differences in average temperatures between Muizenberg and the remaining sites, , with the differences increasing annually throughout 1972 and 2016 during winter. Similarly, differences of average temperatures also increased between Kalk Bay and Muizenberg during these same months. In the summer and spring months we saw relatively little differences in average temperatures between sites, with minimal differences in the rates of these changes. These rates increased during spring.

## Anova test

```{r, echo= FALSE, message=FALSE, warning=FALSE}
# library(knitr)
# anova_test_2 <- read_csv("data/anova_test_2.csv")
# colnames(anova_test_2) <- c("Df", "Sum Sq", "F value", "Pr(>F")
# try1 <- anova_test[(0:47), ]
# kable(try1, row.names = FALSE, caption = "anova test.")

anova_clus_1_func1 <- anova_func(df = SACTN_clust_1_matched)
summary(anova_clus_1_func1)
anova_clus_2_func1 <- anova_func(df = SACTN_clust_2_matched)
summary(anova_clus_2_func1)
anova_clus_3_func1 <- anova_func(df = SACTN_clust_3_matched)
summary(anova_clus_3_func1)
anova_clus_4_func1 <- anova_func(df = SACTN_clust_4_matched)
summary(anova_clus_4_func1)
anova_clus_5_func1 <- anova_func(df = SACTN_clust_5_matched)
summary(anova_clus_5_func1)
anova_clus_6_func1 <- anova_func(df = SACTN_clust_6_matched)
summary(anova_clus_6_func1)
```

### Average temperature of clustered sites:

In the first cluster of sites, via the results of a one way ANOVA tests it was found that there was a significant differences in average temperatures between paired sites (F2 = 12.07, SS = 15.28, P < 0.001). These differences were present across season (F6 = 3.44, SS = 13.07, P < 0.002) but were not present yearly between individuals and paired sites (F2 = 1.38, SS = 1.75, P = 0.25). Similarly, paired sites within the second cluster also a significantly differed in average temperature (F2 = 166.84, SS = 418.6, P < 0.001). Conversely to first cluster however these differences were present yearly (F1 = 33.21, SS = 41.7, P < 0.001) and seasonally (F6 = 16.72, SS = 125.9, P < 0.02,) between individual and paired sites. In the third cluster of sites, ANOVA tests revealed that there were no significant differences in average temperatures between paired sites (F2 = 1.17, SS = 2.9, P = 0.31), but temperatures varied seasonally and yearly between individual sites (. In the fourth cluster there were again no significant difference of average temperatures between paired sites (F2 = 0.73, SS = 2.9, P = 0.48). Differences were also absent across seasons (F3 = 0.75, SS = 0.0042, P = 0.52) and years (F1 = 0.495, SS = 0.0009, P = 0.48) between both individual and paired sites.
Sites within the fifth cluster were significantly different in average temperatures between paired sites (F2 = 77.10, SS = 196.7, P < 0.002), with these differences being present yearly (F1 = 172.80, SS = 220.4, P < 0.001) and seasonally (F3 = 77.10, SS = 29.92, P < 0.002) for both paired and individual sites. Finally, sites within the sixth cluster also significantly difference in average temperatures between paired sites, yearly and seasonally (F2 = 132.044, SS = 419.7, P <0.01).

## R2 value representing the influence of each of the wave variables on the insitu collected temperature data 

```{r}
# These data are best represented with a table
knitr::kable(SACTN_7_R2, digits = 3, caption = "R^2 and p-values for the relationship between wave/wind variables and SACTN temperature at 7m.")

# These data are best represented with a table
knitr::kable(SACTN_15_R2, digits = 3, caption = "R^2 and p-values for the relationship between wave/wind variables and SACTN temperature at 15m.")
```

## R2 value representing the influence of each of the wave variables on the AVHRR collected temperature data

```{r}
# These data are best represented with a table
knitr::kable(AVHRR_temp_7_R2, digits = 3, caption = "R^2 and p-values for the relationship between wave/wind variables and AVHRR temperature at 7m.")

# These data are best represented with a table
knitr::kable(AVHRR_temp_15_R2, digits = 3, caption = "R^2 and p-values for the relationship between wave/wind variables and AVHRR temperature at 15m.")
```

## R2 value representing the influence of each of the wave variables on the MUR collected temperature data

```{r}
# These data are best represented with a table
knitr::kable(MUR_7_R2, digits = 3, caption = "R^2 and p-values for the relationship between wave/wind variables and MUR temperature at 7m.")

# These data are best represented with a table
knitr::kable(MUR_5_R2, digits = 3, caption = "R^2 and p-values for the relationship between wave/wind variables and MUR temperature at 15m.")
```

## R2 value representing the influence of each of the wave variables on the CMC collected temperature data

```{r}

# These data are best represented with a table
knitr::kable(CMC_7_R2, digits = 3, caption = "R^2 and p-values for the relationship between wave/wind variables and CMC temperature at 7m.")

# These data are best represented with a table
knitr::kable(CMC_15_R2, digits = 3, caption = "R^2 and p-values for the relationship between wave/wind variables and CMC temperature at 15m.")
```

## R2 value representing the influence of each of the wave variables on the K10 collected temperature data

```{r}
# These data are best represented with a table
knitr::kable(K10_7_R2, digits = 3, caption = "R^2 and p-values for the relationship between wave/wind variables and K10 temperature at 7m.")

# These data are best represented with a table
knitr::kable(K10_15_R2, digits = 3, caption = "R^2 and p-values for the relationship between wave/wind variables and K10 temperature at 15m.")
```

## Wind Rose diagram





## r2 value representing a comparison between the most predominant wind and wave direction and temperature

```{r}
SACTN_7_predom_R2 <- SACTN_daily_clusters_7 %>% 
  temp_wave_predom_R2()

SACTN_15_predom_R2 <- SACTN_daily_clusters_15 %>% 
  temp_wave_predom_R2()

# These data are best represented with a table
knitr::kable(SACTN_7_predom_R2, digits = 3, caption = "R^2 and p-values for the relationship between predominant wind and waves at 7m.")

# These data are best represented with a table
knitr::kable(SACTN_15_predom_R2, digits = 3, caption = "R^2 and p-values for the relationship between temperature and wave/wind variables and K10 temperature at 15m.")
```










## Some discussion points

This study aimed to investigate how environmental factors wind and wave action influenced coastal seawater temperature variation along the South African coastline. Since seawater temperature is known to have large influences on species distributions (Bolton 2010, Smit et al. 2013), it is important to understand not only the variation across the coastline, but the factors driving variations as well. Here, I confiirmed that there were statistically significant differences in SST between the three coasts of South Africa, and that temperatures along these individual coasts varied at differing degrees. I found that the east coast of South Africa had overall little variation in temperatures between sites, whereas the south coast varied more frequently (Schlegel and Smit 2016). 

Previous studies suggest that a longer time series containing more data would be more effective in detecting subtle changes in temperature changes obtained from highly variable coastal regions (Schlegel and Smit 2016). Schlegel and Smit (2016) suggested that having a time series of greater than 30 years for sites with a low variance results in increased ability to detect significant changes (Schlegel and Smit 2016). They showed that high quality time series datasets typically have frequent measurements with minimal missing (NA) values present. Furthermore, low quality dataset (i.e. those with more than 5% of NA values), has an increased chance of detecting variation where none exists.

Because temperature collection along the South African coastline started in the 1970s, and data collection was inconsistent in terms of instruments used, modifications to styles and methods used for data collection, calibration, and the locations where data were collected the metadata for older seawater temperature records within the SACTN dataset may have been lost or are unreliable. This metadata is essential as its absence prevents us from fully understanding the influence that instruments had on the temperature recordings. We do however have an accurate indication of which recordings were measured with thermometers and which were with UTR.

The UTRs used to collect data in the SACTN dataset appear to express a lower number of NA values compared to the data collected with hand thermometers. As such, this may influenced the overall time series dataset (Smit and Schlegel, 2016). The level of precision at which data was collected also influenced the length of the time series needed. Time series in which temperature was collected at a precision of 0.5 degrees C may require another of data of another 24 months to precisely detect long term variation (Smit and Schlegel 2016).The average length of the thermometer time series component of the SACTN dataset was 346 whereas the average length of UTR time series was only 167 months. Knowing this difference in time series lengths, even once correcting for negative effects on the measurement precision of the thermometer collected time series, are essentially more useful compared to UTRs.

Satellite derived SST data are undoubtedly useful. Globally, these data are used in numerous marine focussed studies and are critical in furthering our understanding of coastal systems. Satellite data are often used to model a range of oceanic processes, but only recently have these data been used to study benthic organisms. Here, I found that satellite data were significantly correlated with *in situ* collected temperature data. One potential drawback of this is that SST data derived from satellites are significantly different compared to actual coastal seawater temperatures. This is due to the fact that satellite derived SST data are collected from a thin boundary layer at the air-sea interface and collection is only reliable 10 km from the coast. These data should therefore be interpreted with caution.









