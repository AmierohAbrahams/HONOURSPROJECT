\documentclass[10pt,a4,]{article}
% \RequirePackage[l2tabu, orthodox]{nag}
\usepackage[a4paper,text={16.5cm,25.2cm},centering,margin=2.6cm]{geometry}
% \usepackage[left=1.0in,top=1.0in,right=1.0in,bottom=1.0in]{geometry}
\newcommand*{\authorfont}{\fontfamily{phv}\selectfont}
\usepackage{hyperref,amsmath,amssymb,bm,url,enumitem,dcolumn,upquote,framed,alltt,textgreek,xfrac,fixltx2e}
\usepackage[australian]{babel}
\usepackage[compact,small]{titlesec}
\setlength{\parskip}{1.2ex}
\setlength{\parindent}{0em}

\def\tightlist{}

\usepackage{ifxetex}
\ifxetex
  \usepackage{fontspec}
  \defaultfontfeatures{Ligatures=TeX} % To support LaTeX quoting style
 \defaultfontfeatures{Ligatures=TeX}
 \setmainfont{Minion Pro}
 \setsansfont[Scale=MatchLowercase]{Myriad Pro}
 \setmonofont[Scale=MatchLowercase]{Ubuntu Mono}
\else
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{lmodern}
  % \usepackage[full]{textcomp} % directly use the degree (and some other) symbol
\fi

% place after fonts; even better typesetting for improved readability:
% \graphicspath{ {figure/} }
\usepackage{tabularx} % for 'tabularx' environment and 'X' column type
\usepackage{ragged2e}  % for '\RaggedRight' macro (allows hyphenation)
\usepackage{siunitx}
    \sisetup{%
        detect-mode,
        group-digits            = false,
        input-symbols           = ( ) [ ] - + < > *,
        table-align-text-post   = false,
        round-mode              = places,
        round-precision         = 3
        }
% \usepackage[font={small, sf}, labelfont=bf]{caption} % tweaking the captions
\usepackage[font={small}, labelfont=bf]{caption} % tweaking the captions
\usepackage[color=yellow, textsize=tiny]{todonotes}
\frenchspacing%
% \usepackage[kerning=false,protrusion=true,expansion=true]{microtype}

\usepackage{abstract}
\renewcommand{\abstractname}{} % clear the title
\renewcommand{\absnamepos}{empty} % originally center

\renewenvironment{abstract}
{{%
\setlength{\leftmargin}{0mm}
\setlength{\rightmargin}{\leftmargin}%
}%
\relax}
{\endlist}

\makeatletter
\def\@maketitle{%
\newpage
%  \null
%  \vskip 2em%
%  \begin{center}%
\let \footnote \thanks
 {\fontsize{18}{20}\selectfont\raggedright  \setlength{\parindent}{0pt} \@title \par}%
}
%\fi
\makeatother


\setcounter{secnumdepth}{0}



\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}


\usepackage{longtable,booktabs}
\setlength\heavyrulewidth{0.1em}
\setlength\lightrulewidth{0.0625em}


\title{Quantifying the impact of wind and wave action on seawater temperature
along the South African coastline (Appendices)  }

\author{\Large Amieroh Abrahams\vspace{0.05in} \newline\normalsize\emph{University of the Western Cape}  }

\date{}

% PENALTIES
\widowpenalty=1000
\clubpenalty=1000
\doublehyphendemerits=9999 % Almost no consecutive line hyphens
\brokenpenalty=10000 % No broken words across columns/pages
\interfootnotelinepenalty=9999 % Almost never break footnotes

% SECTION, SUBSECETC.TITLES
\usepackage[compact]{titlesec}
\titleformat{\chapter}
  {\normalfont\LARGE\sffamily\bfseries}
  {\thechapter}
  {1em}
  {}
\titleformat{\section}
  {\normalfont\LARGE\sffamily\bfseries}
  {\thesection}
  {1em}
  {}
\titleformat{\subsection}
  {\normalfont\Large\sffamily\bfseries}
  {\thesubsection}
  {1em}
  {}
\titleformat{\subsubsection}
  {\normalfont\large\sffamily\bfseries\slshape}
  {\thesubsubsection}
  {1em}
  {}
% \titlespacing*{<command>}{<left>}{<before-sep>}{<after-sep>}
\titlespacing*{\chapter}
  {0pt}
  {1.2ex plus 1ex minus .2ex}
  {0.5ex plus .1ex minus .1ex}
\titlespacing*{\section}
  {0pt}
  {1.2ex plus 1ex minus .2ex}
  {0.5ex plus .1ex minus .1ex}
\titlespacing*{\subsection}
  {0pt}
  {1.2ex plus 1ex minus .2ex}
  {0.5ex plus .1ex minus .1ex}
\titlespacing*{\subsubsection}
  {0pt}
  {1.2ex plus 1ex minus .2ex}
  {0.5ex plus .1ex minus .1ex}



\newtheorem{hypothesis}{Hypothesis}
\usepackage{setspace}

\makeatletter

\@ifpackageloaded{hyperref}{}{%
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[colorlinks=true, citecolor=blue, linkcolor=cyan, pdfborder={0 0 0 }, unicode=true]{hyperref} % place after other packages, but before cleveref
\fi
}

\@ifpackageloaded{color}{
    \PassOptionsToPackage{usenames,dvipsnames}{color}
}{%
    \usepackage[usenames,dvipsnames]{color}
}

\usepackage{cleveref} % cleverly cross referencing figures and tables; last package to include
\setcounter{secnumdepth}{2}
\setcounter{tocdepth}{2}

% To use for resetting the numbering of Appendix Tables and Figures:
%\setcounter{table}{0}
%\renewcommand{\thetable}{A\arabic{table}}
%\setcounter{figure}{0}
%\renewcommand{\thefigure}{A\arabic{figure}}

\makeatother
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={Amieroh Abrahams (University of the Western Cape)},
             pdfkeywords = {},
            pdftitle={Quantifying the impact of wind and wave action on seawater temperature
along the South African coastline (Appendices)},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls


\begin{document}

% \maketitle

{% \usefont{T1}{pnc}{m}{n}
\setlength{\parindent}{0pt}
\thispagestyle{plain}
{\fontsize{18}{20}\selectfont\raggedright
\maketitle  % title \par
}
{
   \vskip 13.5pt\relax \normalsize\fontsize{11}{12}
\textbf{\authorfont Amieroh Abrahams} \hskip 15pt \emph{\small University of the Western Cape}   
}
}



\vskip 6.5pt

\noindent 

This file was generated in R using Rmarkdown, with a bit of
\LaTeX~thrown in:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sessionInfo}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## R version 3.5.1 (2018-07-02)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS  10.14.1
## 
## Matrix products: default
## BLAS: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
## LAPACK: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] RevoUtils_11.0.1
## 
## loaded via a namespace (and not attached):
##  [1] compiler_3.5.1  backports_1.1.2 magrittr_1.5    rprojroot_1.3-2
##  [5] tools_3.5.1     htmltools_0.3.6 yaml_2.2.0      Rcpp_1.0.0     
##  [9] stringi_1.2.4   rmarkdown_1.10  knitr_1.20      stringr_1.3.1  
## [13] digest_0.6.18   evaluate_0.12
\end{verbatim}

\newpage

\section*{\large{Appendix A}}

\subsection*{Background and code}

The intention of this section is to show the approach and \textbf{R}
scripts used to analyse the possible reasons for temperature variation
between sites within the same cluster along the coast of South Africa.
Specifically, I wish to determine if wave and wind action are the
possible reasons for this variation.

\subsubsection*{The data}

The SACTN dataset is the primary source of temperature data used in this
study. This dataset consisted of \emph{in situ} collected coastal
seawater temperatures for 129 sites along the coast of South Africa,
measured daily from 1972 until 2017. This study also make use of AVHRR,
MUR, CMC and K10 satellite-derived SST datasets as well as wind and wave
action data that were obtained from the South African Weather Service
(SAWS), and were provided at three hour resolutions. This data was then
used to model short--crested waves, generated by the wind into the
coastal environment, using the wave model Simulating Waves in the
Nearshore (SWAN).

\subsubsection*{Setting up the analysis}

This is \textbf{R}, so first I need to find, install and load various
packages. Some of the packages will be available on CRAN and can be
accessed and installed in the usual way.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(tidyverse)}
\KeywordTok{library}\NormalTok{(ggpubr)}
\KeywordTok{library}\NormalTok{(zoo)}
\KeywordTok{library}\NormalTok{(lubridate)}
\KeywordTok{library}\NormalTok{(ggrepel)}
\KeywordTok{library}\NormalTok{(FNN)}
\KeywordTok{library}\NormalTok{(stringr)}
\KeywordTok{library}\NormalTok{(circular)}
\KeywordTok{library}\NormalTok{(broom)}
\KeywordTok{library}\NormalTok{(ggrepel)}
\KeywordTok{library}\NormalTok{(purrr)}
\KeywordTok{library}\NormalTok{(stlplus)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../functions/earthdist.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../functions/scale.bar.func.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../functions/wind.rose.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../functions/waverose.diagram.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../functions/match_func.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../functions/seasonal_match.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../functions/anova_func.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../functions/Load_wave_function.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../functions/R_func.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../functions/temp_r2.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../functions/temp_wave_r2.R"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\newpage

\section*{\large{Appendix B}}

Now to get to the data. Here I load the site list dataset. This dataset
comprise of the statistical properties of the seawater temperature
representing the South African coastline, such as the mean, minimum and
maximum temperatures. These values vary among coastal sections due to
the influence of the cold Benguala and warm Agulhas currents. At the
broad scale, this region exhibits a large variation in seawater
temperatures along its coastline (Mead et al., 2013; Smit et al., 2013)
and is divided into four bioregions, each with contrasting temperatures.
These bioregions are the Benguela Marrine Province (BMP),
Benguela-Agulhas Transition Zone (B-ATZ), the Agulhas Marine Province
(AMP) and the East Coast Transition Zone (ECTZ) (Smit et al., 2017). The
Benguela Marine Province (BMP) is located to the west of Cape Point and
is characterized by the movement of cold water from the Southern Ocean
moving north. The cold temperate west coast mentioned above is greatly
affected by the upwelling caused by offshore winds, generated by the
cold Benguela current. Thus the seawater temperatures found around South
Africa's coastline exhibits a large variational range. My plotting
functions partition the data into the clusters and colour code each
point accordingly so that I am able to see patterns that exist and
distictly group the different sites with similar temperatures along the
three distinct coasts.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/site_list_v4.2.RData"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\newpage

The next step involves SACTN temperature dataset. First I compute a
k-means clustering on a data matrix using the \texttt{kmeans()}
function, which uses multiple random seeds to find a number of clusting
solutions. This groups sites based on minimum, maximum and mean
temperatures. Thereafter I select all the sites with a overlapping time
series of at least 10 years of data and excluding temperatures collected
deeper than 5m.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\StringTok{"../SACTN_data/SACTN_daily_v4.2.RData"}\NormalTok{)}

\KeywordTok{set.seed}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\NormalTok{site_list}\OperatorTok{$}\NormalTok{cluster <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(}\KeywordTok{kmeans}\NormalTok{(site_list[,}\KeywordTok{c}\NormalTok{(}\DecValTok{15}\NormalTok{, }\DecValTok{18}\OperatorTok{:}\DecValTok{19}\NormalTok{)], }\DecValTok{6}\NormalTok{)}\OperatorTok{$}\NormalTok{cluster)}

\NormalTok{site_list_clusters <-}\StringTok{ }\NormalTok{site_list }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(length }\OperatorTok{>=}\StringTok{ }\DecValTok{3650}\NormalTok{, depth }\OperatorTok{<=}\StringTok{ }\DecValTok{5}\NormalTok{)}

\NormalTok{SACTN_daily_clusters <-}\StringTok{ }\NormalTok{SACTN_daily_v4}\FloatTok{.2} \OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{left_join}\NormalTok{(site_list[,}\KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{21}\NormalTok{)], }\DataTypeTok{by =} \StringTok{"index"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(index }\OperatorTok{%in%}\StringTok{ }\NormalTok{site_list_clusters}\OperatorTok{$}\NormalTok{index)}
\end{Highlighting}
\end{Shaded}

With the sites now split into eight clusters, the next step is to reduce
the number of sites per cluster down to a manageable, but still
representative, sub-sample of the whole. This is done primarily for two
reasons. The first, simply, is to allow for the comparisons to be more
readily interpretable by humans. The second more objective reason is to
allow for an equal amount of sampling per cluster. The East coast is
much more heavily sampled than the rest and so this imbalance must be
addressed. The criteria that must be considered for the sub-samples are
that both instrument types (UTR and thermometer) are present, and as
many sources are included as are possible. This thermal data contain
various variables, in this study I only make use of some of them. This
resulted in 18 sites, three per cluster. My plotting functions partition
the data into its respective groups and colour code the figures
accordingly.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Read in the species data}
\CommentTok{# Will be provided -- in the data folder as "site_list_sub.RData"}

\CommentTok{# save(site_list_sub, file = "data/site_list_sub.RData")}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/site_list_sub.RData"}\NormalTok{)}
\NormalTok{SACTN_daily_clusters_sub <-}\StringTok{ }\NormalTok{SACTN_daily_clusters }\OperatorTok{%>%}\StringTok{   }\CommentTok{#Subsetting the data}
\StringTok{  }\KeywordTok{filter}\NormalTok{(index }\OperatorTok{%in%}\StringTok{ }\NormalTok{site_list_sub}\OperatorTok{$}\NormalTok{index)}
\CommentTok{# Saving the data for later use}
\CommentTok{# save(SACTN_daily_clusters_sub,}
\CommentTok{#      file = "data/SACTN_daily_clusters_sub.RData") }
\end{Highlighting}
\end{Shaded}

\begin{tiny}
\begin{center}
\setlength\tabcolsep{3pt}
\begin{longtable}{|r|r|r|l|p{6cm}|}
\caption{The 18 sites along the South African coastline, with approximate GPS coordinates, source and the cluster of which each site belong to based on maximum, minimum and mean temperature} \\

% This is the header for the first page of the table...
\toprule
Cluster & Site & SRC & Lon & Lat  \\
\midrule
\endfirsthead

% This is the header for the second page of the table...
\toprule
Cluster & Site & SRC & Lon & Lat  \\
\midrule
\endhead

% This is the footer for all pages except the last page of the table...
\midrule
\multicolumn{5}{l}{{Continued on Next Page\ldots}} \\
\endfoot

% This is the footer for the last page of the table...
\bottomrule
\endlastfoot

% Now the data...

1 & Hamburg & DEA & 27.49 & -33.29 \\
1 & Eastern Beach & SAWS & 27.92 & -33.02 \\
1 & Orient Beach & SAWS & 27.92 & -33.02 \\
2 & Stilbaai & SAWS & 21.44 & -34.37 \\
2 & Mossel Bay & SAWS & 22.13 & -34.17 \\
2 & Knysna & SAWS & 23.05 & -34.09 \\
3 & Saldanha Bay & SAWS & 17.95 & -33.01 \\
3 & Bordjies & DAFF & 18.46 & -34.32 \\
3 & Gansbaai & SAWS & 19.34 & -34.59 \\
4 & Port Edward & KZNSB & 30.23 & -31.04 \\
4 & T.O. Strand & KZNSB & 30.23 & -31.03 \\
4 & Leisure Bay & KZNSB & 30.25 & -31.02 \\
5 & Port Nolloth & SAWS & 16.87 & -29.25 \\
5 & Lamberts Bay & SAWS & 18.30 & -32.09 \\
5 & Sea Point & SAWS & 18.38 & -33.92 \\
6 & Kalk Bay & SAWS & 18.45 & -34.13 \\
6 & Muizenberg & SAWS & 18.48 & -34.10 \\
6 & Gordons Bay & SAWS & 18.86 & -34.16 \\

\end{longtable}
\end{center}
\end{tiny}

With the temperature data now loaded in, I am now able to calculate the
distance between each of the sites. Here I set up a geographic or
Euclidian distance matrix representing the pairwise distances between
the \(n\) sites (\(D=[d_{ij}]\)). I already have a function for this and
can be found in the folder titled functions.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/sa_coast.Rdata"}\NormalTok{) }\CommentTok{# Coastal data}
\KeywordTok{options}\NormalTok{(}\DataTypeTok{scipen=}\DecValTok{999}\NormalTok{) }\CommentTok{# Forces R to not use exponential notation}
\NormalTok{sa_coast_prep <-}\StringTok{ }\NormalTok{sa_coast }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{site =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(.),}
         \DataTypeTok{X =} \KeywordTok{deg2rad}\NormalTok{(X),}
         \DataTypeTok{Y =} \KeywordTok{deg2rad}\NormalTok{(Y)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(site, X, Y)}

\NormalTok{sa_coast_dist <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{round}\NormalTok{(}\KeywordTok{PairsDists}\NormalTok{(sa_coast_prep), }\DecValTok{2}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{lon =}\NormalTok{ sa_coast}\OperatorTok{$}\NormalTok{X,}
         \DataTypeTok{lat =}\NormalTok{ sa_coast}\OperatorTok{$}\NormalTok{Y) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{rename}\NormalTok{(}\DataTypeTok{dist =}\NormalTok{ V1) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{(lon, lat, dist) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{cum_dist =} \KeywordTok{cumsum}\NormalTok{(dist)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{dist =} \KeywordTok{lag}\NormalTok{(dist),}
         \DataTypeTok{cum_dist =} \KeywordTok{lag}\NormalTok{(cum_dist))}
\end{Highlighting}
\end{Shaded}

\subsubsection*{Matching sites based on overlapping time series}

Next I create a function to match the sites with each of the clusters.
This allows me to compare whether or not a temperature variation exist
between sites within the same cluster and to examine reasons for this
variation. Here I also consider distance between sites.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_1_match.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_2_match.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_3_match.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_4_match.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_5_match.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_6_match.RData"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

I then create a function which allows me to calculate the monthly mean
temperature and standard deviation for each year and sites. Consequently
we have a dataframe with seven columns and each of the rows representing
each month for each of the years. By calculating the mean and SD for
each site I am able identify trends in their temperatures and to compare
these trends across sites within the same cluster. Mean and SD gives a
broad look of the overall temperature for each of the sites. With each
group of months representing the season.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_1_matched.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_2_matched.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_3_matched.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_4_matched.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_5_matched.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_clust_6_matched.RData"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsubsection*{Analyses}

Here I do a three way ANOVA analayses. This allows me to compare one
variable in two or more groups taking into account the variability of
other variables. This analysis of covariance is used to test the main
effect of variables on a continuous variable. In this case we
specifically analyse the relationship between the average temperature as
a function of index pair (Paired sites), year and season. For this I
create a function and so I replicate the same test for each of the six
clusters.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{anova_clus_}\DecValTok{1}\NormalTok{_func1 <-}\StringTok{ }\KeywordTok{anova_func}\NormalTok{(}\DataTypeTok{df =}\NormalTok{ SACTN_clust_}\DecValTok{1}\NormalTok{_matched)}
\KeywordTok{summary}\NormalTok{(anova_clus_}\DecValTok{1}\NormalTok{_func1)}
\NormalTok{anova_clus_}\DecValTok{2}\NormalTok{_func1 <-}\StringTok{ }\KeywordTok{anova_func}\NormalTok{(}\DataTypeTok{df =}\NormalTok{ SACTN_clust_}\DecValTok{2}\NormalTok{_matched)}
\KeywordTok{summary}\NormalTok{(anova_clus_}\DecValTok{2}\NormalTok{_func1)}
\NormalTok{anova_clus_}\DecValTok{3}\NormalTok{_func1 <-}\StringTok{ }\KeywordTok{anova_func}\NormalTok{(}\DataTypeTok{df =}\NormalTok{ SACTN_clust_}\DecValTok{3}\NormalTok{_matched)}
\KeywordTok{summary}\NormalTok{(anova_clus_}\DecValTok{3}\NormalTok{_func1)}
\NormalTok{anova_clus_}\DecValTok{4}\NormalTok{_func1 <-}\StringTok{ }\KeywordTok{anova_func}\NormalTok{(}\DataTypeTok{df =}\NormalTok{ SACTN_clust_}\DecValTok{4}\NormalTok{_matched)}
\KeywordTok{summary}\NormalTok{(anova_clus_}\DecValTok{4}\NormalTok{_func1)}
\NormalTok{anova_clus_}\DecValTok{5}\NormalTok{_func1 <-}\StringTok{ }\KeywordTok{anova_func}\NormalTok{(}\DataTypeTok{df =}\NormalTok{ SACTN_clust_}\DecValTok{5}\NormalTok{_matched)}
\KeywordTok{summary}\NormalTok{(anova_clus_}\DecValTok{5}\NormalTok{_func1)}
\NormalTok{anova_clus_}\DecValTok{6}\NormalTok{_func1 <-}\StringTok{ }\KeywordTok{anova_func}\NormalTok{(}\DataTypeTok{df =}\NormalTok{ SACTN_clust_}\DecValTok{6}\NormalTok{_matched)}
\KeywordTok{summary}\NormalTok{(anova_clus_}\DecValTok{6}\NormalTok{_func1)}
\end{Highlighting}
\end{Shaded}

Hereafter, I create a box plot also allowing me to observe whether or
not a variation exist between sites within the same cluster. Box plots
determine the strength of correlation of temperature between sites found
within the same clusters along the coast. Similarly, I create a line
plot, using the gam function in R. This allows me to assess whether or
not an average temperature differences exist between sites on a seasonal
basis and to examine the intensity of this variation over the past
years. Due to the length of the ouput I have prevented the scrript from
returning here. The scipt however may be found in my
\href{https://github.com/amierohabrahams/HONOURSPROJECT}{GitHub}
repository, and the full code can be run in its entiety.

\section*{\large{Appendix C}}
\subsubsection*{Wind and wave data}

Since the analysis prove that temperature variation exist between sites
within the same cluster, I now continue with the analyses to determine
if wind and wave action are the possible causes for this variation. Here
I created a function to load in the wind and wave data. This data is
presented in single folders for each of the 18 sites and as a result I
will not be adding the code here. As mentioned earlier, this code is
present in my Github repository.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# source("functions/Load wave function.R") # I load this function in the code above}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/wave_data.RData"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Wave and wind data were modelled at three hour resolutions and at 7 and
15m isobaths. I now converted the data into daily data points in order
to compare them with the temperature data, which is collected daily. The
\texttt{circular()} function in R software is then used to create
circular objects around the wave data in order to calculate the daily
wave and wind parameters.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/wave_daily.RData"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Now that I have the daily values for the wind and wave variables, I am
able to split the dataset into depths of 7 and 15m.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sites_complete_7a <-}\StringTok{ }\NormalTok{wave_daily }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{filter}\NormalTok{(depth }\OperatorTok{==}\StringTok{ "7m"}\NormalTok{)}

\NormalTok{sites_complete_15a <-}\StringTok{ }\NormalTok{wave_daily }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{filter}\NormalTok{(depth }\OperatorTok{==}\StringTok{ "15m"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Next I want to show the relationship between temperature and wind and
wave action. I create a function matching the wind and wave data with
the SACTN temperature data. This allows for further analyses.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{SACTN_daily_clusters_sub_}\DecValTok{1}\NormalTok{ <-}\StringTok{ }\NormalTok{SACTN_daily_clusters_sub }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{separate}\NormalTok{(index, }\DataTypeTok{into =} \KeywordTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{, }\StringTok{"src"}\NormalTok{), }\DataTypeTok{sep =} \StringTok{"/"}\NormalTok{, }\DataTypeTok{remove =} \OtherTok{FALSE}\NormalTok{)}

\NormalTok{try1 <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(df) \{}
\NormalTok{  func1 <-}\StringTok{ }\NormalTok{df }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{left_join}\NormalTok{(sites_complete_7a, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{, }\StringTok{"date"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{na.trim}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{group_by}\NormalTok{(site)}
    \KeywordTok{return}\NormalTok{(func1)}
\NormalTok{\}}
\NormalTok{try2 <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(df) \{}
\NormalTok{  func2 <-}\StringTok{ }\NormalTok{df }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{left_join}\NormalTok{(sites_complete_15a, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{, }\StringTok{"date"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{na.trim}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{group_by}\NormalTok{(site)}
    \KeywordTok{return}\NormalTok{(func2)}
\NormalTok{\}}

\NormalTok{SACTN_daily_clusters_7a <-}\StringTok{ }\KeywordTok{try1}\NormalTok{(}\DataTypeTok{df =}\NormalTok{ SACTN_daily_clusters_sub_}\DecValTok{1}\NormalTok{)}
\NormalTok{SACTN_daily_clusters_15a <-}\StringTok{ }\KeywordTok{try2}\NormalTok{(}\DataTypeTok{df =}\NormalTok{ SACTN_daily_clusters_sub_}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

With the wind and wave data now matching the temperature data based on
the date and site at which temperature was collected, I am now able to
do a regression analyses. Here I create a function which calculates the
coefficient of determination (\emph{R}\textsuperscript{2}). The
coeffcient of determination was calculated to determine how differences
in one variable can be explained by a difference in the second variable.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# source("functions/R_func.R")}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_7_R2.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_15_R2.RData"}\NormalTok{)}

\NormalTok{SACTN_}\DecValTok{7}\NormalTok{_R2 <-}\StringTok{ }\NormalTok{SACTN_daily_clusters_7a }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{temp_wave_R2_}\NormalTok{()}
\NormalTok{SACTN_}\DecValTok{15}\NormalTok{_R2 <-}\StringTok{ }\NormalTok{SACTN_daily_clusters_15a }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{temp_wave_R2_}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

I repeat the above code, allowing me to match the wind and wave data
with the satellite collected SST data. Due to the length of script I do
not include this here. The scipt however may be found in my
\href{https://github.com/amierohabrahams/HONOURSPROJECT}{GitHub}
repository, as previously mentioned. I now read in the
\emph{R}\textsuperscript{2} value results for each of the satellite
datasets.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/AVHRR_temp_7_R2.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/AVHRR_temp_15_R2.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/CMC_7_R2.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/CMC_15_R2.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/K10_7_R2.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/K10_15_R2.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/MUR_7_R2.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/MUR_15_R2.RData"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

The \emph{R}\textsuperscript{2} values indicate that wind and wave
action has no significant impact on temperature variation along the
South African coastline, my next step is to determine the most
predominant wind and wave direction for each of the 18 sites. By doing
this I am able to determine whether or not predominant wind and wave
direction may have a greater effect on temperature at each of the sites.
Here I again make use of the \texttt{circular()} function which
calculates the circular statistic for wind and wave direction only. I
then split these dataset into two seperate datasets comprising of wind
and wave data collected at 7 and 15m respectively.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wave_daily_dir <-}\StringTok{ }\NormalTok{wave_data }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{date =} \KeywordTok{as.Date}\NormalTok{(date)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{group_by}\NormalTok{(site, num, depth, date) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{dir_circ =} \KeywordTok{mean.circular}\NormalTok{(}\KeywordTok{circular}\NormalTok{(dir, }\DataTypeTok{units =} \StringTok{"degrees"}\NormalTok{)),}
            \DataTypeTok{dirw_circ =} \KeywordTok{mean.circular}\NormalTok{(}\KeywordTok{circular}\NormalTok{(dirw, }\DataTypeTok{units =} \StringTok{"degrees"}\NormalTok{))) }

\NormalTok{wave_daily <-}\StringTok{ }\NormalTok{wave_data }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{date =} \KeywordTok{as.Date}\NormalTok{(date)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{group_by}\NormalTok{(site, num, depth, date) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{summarise_all}\NormalTok{(}\KeywordTok{funs}\NormalTok{(}\DataTypeTok{mean =}\NormalTok{ mean, }\DataTypeTok{sd =}\NormalTok{ sd), }\DataTypeTok{na.rm =}\NormalTok{ T) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ungroup}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{left_join}\NormalTok{(wave_daily_dir)}

\NormalTok{sites_complete_}\DecValTok{7}\NormalTok{ <-}\StringTok{ }\NormalTok{wave_daily }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{filter}\NormalTok{(depth }\OperatorTok{==}\StringTok{ "7m"}\NormalTok{)}

\NormalTok{sites_complete_}\DecValTok{15}\NormalTok{ <-}\StringTok{ }\NormalTok{wave_daily }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{filter}\NormalTok{(depth }\OperatorTok{==}\StringTok{ "15m"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Splitting the waves up into two different dataframes requires me to
write a bit more code, but ultimately makes it easier to read. The
argument \texttt{s.window} controls how rapidly the seasonal component
can change. Small values allow more rapid change. Setting the seasonal
window to be infinite is equivalent to forcing the seasonal component to
be periodic. The stlplus package for R has a plot\_seasonal function
that can be used to generate a cycle-subseries plot in order to visually
calibrate \texttt{s.window}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Create site column from the index column}
\NormalTok{SACTN_daily_clusters_sub <-}\StringTok{ }\NormalTok{SACTN_daily_clusters_sub }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{separate}\NormalTok{(index, }\DataTypeTok{into =} \KeywordTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{, }\StringTok{"src"}\NormalTok{), }\DataTypeTok{sep =} \StringTok{"/"}\NormalTok{, }\DataTypeTok{remove =} \OtherTok{FALSE}\NormalTok{)}

\CommentTok{# Combine the temperature and 7 m depth wave data}
\NormalTok{SACTN_daily_clusters_}\DecValTok{7}\NormalTok{ <-}\StringTok{ }\NormalTok{SACTN_daily_clusters_sub }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{left_join}\NormalTok{(sites_complete_}\DecValTok{7}\NormalTok{, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{, }\StringTok{"date"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{na.trim}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(site) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{temp_flat =} \KeywordTok{stlplus}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ temp, }\DataTypeTok{n.p =} \DecValTok{365}\NormalTok{, }\DataTypeTok{s.window =} \StringTok{"periodic"}\NormalTok{)[[}\DecValTok{1}\NormalTok{]]}\OperatorTok{$}\NormalTok{remainder)}

\CommentTok{# Combine the temperature and 15 m depth wave data}
\NormalTok{SACTN_daily_clusters_}\DecValTok{15}\NormalTok{ <-}\StringTok{ }\NormalTok{SACTN_daily_clusters_sub }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{left_join}\NormalTok{(sites_complete_}\DecValTok{15}\NormalTok{, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{, }\StringTok{"date"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{na.trim}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(site) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{temp_flat =} \KeywordTok{stlplus}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ temp, }\DataTypeTok{n.p =} \DecValTok{365}\NormalTok{, }\DataTypeTok{s.window =} \StringTok{"periodic"}\NormalTok{)[[}\DecValTok{1}\NormalTok{]]}\OperatorTok{$}\NormalTok{remainder)}
\end{Highlighting}
\end{Shaded}

\hypertarget{comparing-waves-and-temperatures}{%
\subsubsection{Comparing waves and
temperatures}\label{comparing-waves-and-temperatures}}

With our temperature and wave values paired up we now want to
investigate what the relationship between these values may be. In order
to do so we will use linear models, as this produces for us the
coefficient of determination (\emph{R}\textsuperscript{2}). We are going
to use \textbf{\texttt{purrr}} to do this as it will allow us to compare
multiple variables at once: The following example uses purrr to solve a
fairly realistic problem: split a data frame into pieces, fit a model to
each piece, compute the summary, then extract the
\emph{R}\textsuperscript{2}. The \emph{R}\textsuperscript{2} value is a
statistical measure of how close the data are to the fitted regression
line. The \emph{R}\textsuperscript{2} is the percentage of the response
variable variation that is explained by a linear model.

Due to the rather low \emph{R}\textsuperscript{2} values found above,
the follow up is to ascertain what the potential relationship is at each
site only during the prevailing wind/wave directions. Here I create a
function which selects the most predominant wind and wave direction at
each of the sites.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# A function that runs a linear model on each metric of the combined data and get the R^2 value}
\NormalTok{temp_wave_predom_R2 <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(df)\{}
  \CommentTok{# Find predominant wave direction}
\NormalTok{  predom_dir <-}\StringTok{ }\NormalTok{df }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{dir_round =} \KeywordTok{round}\NormalTok{(dir_mean, }\DecValTok{-1}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{group_by}\NormalTok{(cluster, site, dir_round) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{dir_mean_n =} \KeywordTok{n}\NormalTok{()) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{na.omit}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{filter}\NormalTok{(dir_mean_n }\OperatorTok{==}\StringTok{ }\KeywordTok{max}\NormalTok{(dir_mean_n)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{dir_mean_n)}
  \CommentTok{# Find predominant wind direction}
\NormalTok{  predom_dirw <-}\StringTok{ }\NormalTok{df }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{dirw_round =} \KeywordTok{round}\NormalTok{(dirw_mean, }\DecValTok{-1}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{group_by}\NormalTok{(cluster, site, dirw_round) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{dirw_mean_n =} \KeywordTok{n}\NormalTok{()) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{na.omit}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{filter}\NormalTok{(dirw_mean_n }\OperatorTok{==}\StringTok{ }\KeywordTok{max}\NormalTok{(dirw_mean_n))}\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{dirw_mean_n)}
  
  \CommentTok{# Extract just those values}
  \CommentTok{## waves}
\NormalTok{  df_dir <-}\StringTok{ }\NormalTok{df }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{dir_round =} \KeywordTok{round}\NormalTok{(dir_mean, }\DecValTok{-1}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{right_join}\NormalTok{(predom_dir, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{, }\StringTok{"cluster"}\NormalTok{, }\StringTok{"dir_round"}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{dir_round) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{temp_wave_R2}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{right_join}\NormalTok{(predom_dir, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{, }\StringTok{"cluster"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{rename}\NormalTok{(}\DataTypeTok{predom =}\NormalTok{ dir_round) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{predom_var =} \StringTok{"dir"}\NormalTok{)}
  \CommentTok{## wind}
\NormalTok{  df_dirw <-}\StringTok{ }\NormalTok{df }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{dirw_round =} \KeywordTok{round}\NormalTok{(dirw_mean, }\DecValTok{-1}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{right_join}\NormalTok{(predom_dirw, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{, }\StringTok{"cluster"}\NormalTok{, }\StringTok{"dirw_round"}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{dirw_round) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{temp_wave_R2}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{right_join}\NormalTok{(predom_dirw, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{, }\StringTok{"cluster"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{rename}\NormalTok{(}\DataTypeTok{predom =}\NormalTok{ dirw_round) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{predom_var =} \StringTok{"dirw"}\NormalTok{)}
  
  \CommentTok{# Wrap it up}
\NormalTok{  results <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(df_dir, df_dirw)}
  \KeywordTok{return}\NormalTok{(results)}
\NormalTok{\}}

\NormalTok{SACTN_}\DecValTok{7}\NormalTok{_predom_R2 <-}\StringTok{ }\NormalTok{SACTN_daily_clusters_}\DecValTok{7} \OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{temp_wave_predom_R2}\NormalTok{()}

\NormalTok{SACTN_}\DecValTok{15}\NormalTok{_predom_R2 <-}\StringTok{ }\NormalTok{SACTN_daily_clusters_}\DecValTok{15} \OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{temp_wave_predom_R2}\NormalTok{()}

\CommentTok{# save(SACTN_7_predom_R2, file = "data/SACTN_7_predom_R2.RData")}
\CommentTok{# save(SACTN_15_predom_R2, file = "data/SACTN_15_predom_R2.RData")}

\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_7_predom_R2.RData"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"../data/SACTN_15_predom_R2.RData"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Now I make a visualisation to reveal the \emph{R}\textsuperscript{2}
values obtained when comparing the most prevailing wind and wave
direction on temperature.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{addline_format <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x,...)\{}
  \KeywordTok{gsub}\NormalTok{(}\StringTok{'-'}\NormalTok{, }\StringTok{'}\CharTok{\textbackslash{}n}\StringTok{'}\NormalTok{, x)}
\NormalTok{\}}

\NormalTok{renamed_SACTN_}\DecValTok{7}\NormalTok{_predom_R2 <-}\StringTok{ }\NormalTok{SACTN_}\DecValTok{7}\NormalTok{_predom_R2 }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{rename}\NormalTok{(}\DataTypeTok{Variables =}\NormalTok{ variable)}

\NormalTok{predominant_ww <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ renamed_SACTN_}\DecValTok{7}\NormalTok{_predom_R2, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{addline_format}\NormalTok{(Variables), }\DataTypeTok{y =}\NormalTok{ adj.r.squared)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_boxplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{colour =}\NormalTok{ Variables)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{facet_wrap}\NormalTok{(}\OperatorTok{~}\NormalTok{site, }\DataTypeTok{ncol =} \DecValTok{6}\NormalTok{, }\DataTypeTok{nrow =} \DecValTok{3}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{y =} \StringTok{"Coefficient of determination"}\NormalTok{,}
       \DataTypeTok{x =} \StringTok{"Average wind and wave variables"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_x_discrete}\NormalTok{(}\DataTypeTok{labels =} \KeywordTok{c}\NormalTok{(}\StringTok{'dir'}\NormalTok{,}\StringTok{'dirw'}\NormalTok{,}\StringTok{'hs'}\NormalTok{, }\StringTok{'spw'}\NormalTok{, }\StringTok{'tp'}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_manual}\NormalTok{(}\DataTypeTok{labels =} \KeywordTok{c}\NormalTok{(}\StringTok{"dir"}\NormalTok{, }\StringTok{"dirw"}\NormalTok{, }\StringTok{"hs"}\NormalTok{, }\StringTok{"spw"}\NormalTok{,}\StringTok{"tp"}\NormalTok{),}
                     \DataTypeTok{values =} \KeywordTok{c}\NormalTok{(}\StringTok{"firebrick2"}\NormalTok{, }\StringTok{"slate gray3"}\NormalTok{,}\StringTok{"deepskyblue"}\NormalTok{,}\StringTok{"gold1"}\NormalTok{,}\StringTok{"darkorchid1"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme_bw}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{strip.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{25}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =} \DecValTok{20}\NormalTok{)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{20}\NormalTok{),}
          \DataTypeTok{axis.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{25}\NormalTok{),}
          \DataTypeTok{legend.text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{20}\NormalTok{),}
          \DataTypeTok{legend.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{25}\NormalTok{)) }
\NormalTok{predominant_ww}
\end{Highlighting}
\end{Shaded}

I now create a wind and wave rose diagram. Wind and wave diagrams help
visualise the patterns present at a particular site. Moving outward on
the radial scale, the frequency associated with wind and waves coming
from a partiular direction increases. Here I create a function to create
snooty wind and wave plots. As before the functions are ran in the setup
chunk of code at the begining of this document.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# source("functions/wind.rose.R")}

\CommentTok{# Now for creating the wind rose diagram}

\NormalTok{wave_daily_renamed <-}\StringTok{ }\NormalTok{wave_daily }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{rename}\NormalTok{(}\DataTypeTok{spd =}\NormalTok{ spw_mean) }\OperatorTok{%>%}
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{rename}\NormalTok{(}\DataTypeTok{dir =}\NormalTok{ dirw_mean) }

\NormalTok{p.wr2 <-}\StringTok{ }\KeywordTok{plot.windrose}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ wave_daily_renamed,}
              \DataTypeTok{spd =} \StringTok{"spd"}\NormalTok{,}
              \DataTypeTok{dir =} \StringTok{"dir"}\NormalTok{)}

\NormalTok{p.wr3 <-}\StringTok{ }\NormalTok{p.wr2 }\OperatorTok{+}\StringTok{ }\KeywordTok{facet_wrap}\NormalTok{(.}\OperatorTok{~}\StringTok{ }\NormalTok{site, }\DataTypeTok{ncol =} \DecValTok{4}\NormalTok{, }\DataTypeTok{nrow =} \DecValTok{5}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{strip.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{25}\NormalTok{))}
\NormalTok{p.wr3}

\CommentTok{# ggsave(plot = p.wr3, filename = "figures/p.wr3.png")}
\end{Highlighting}
\end{Shaded}

Now for visualising the wave rose diagram

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# source("functions/waverose.diagram.R")}

\CommentTok{# Now for creating the wave rose diagram}

\NormalTok{wave_daily_renamed <-}\StringTok{ }\NormalTok{wave_daily }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{rename}\NormalTok{(}\DataTypeTok{spd =}\NormalTok{ hs_mean) }\OperatorTok{%>%}
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{rename}\NormalTok{(}\DataTypeTok{dir =}\NormalTok{ dir_mean) }

\NormalTok{p.wr2 <-}\StringTok{ }\KeywordTok{plot.waverose}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ wave_daily_renamed,}
              \DataTypeTok{spd =} \StringTok{"spd"}\NormalTok{,}
              \DataTypeTok{dir =} \StringTok{"dir"}\NormalTok{) }
\NormalTok{p.wr2}

\NormalTok{p.wave <-}\StringTok{ }\NormalTok{p.wr2 }\OperatorTok{+}\StringTok{ }\KeywordTok{facet_wrap}\NormalTok{(}\OperatorTok{~}\NormalTok{site,}
                            \DataTypeTok{ncol =} \DecValTok{6}\NormalTok{, }\DataTypeTok{nrow =} \DecValTok{3}\NormalTok{)}
\NormalTok{p.wave}

\CommentTok{# ggsave(plot = p.wave, filename = "figures/p.wave.pdf")}
\end{Highlighting}
\end{Shaded}

\subsection*{References}

\hypertarget{refs}{}
\leavevmode\hypertarget{ref-Mead2013}{}%
Mead, A., Griffiths, C., Branch, G., McQuaid, C., Blamey, L., Bolton,
J., et al. (2013). Human-mediated drivers of change---impacts on coastal
ecosystems and marine biota of south africa. \emph{African Journal of
Marine Science} 35, 403--425.

\leavevmode\hypertarget{ref-Smit2017}{}%
Smit, A. J., Bolton, J. J., and Anderson, R. J. (2017). Seaweeds in two
oceans: Beta-diversity. \emph{Frontiers in Marine Science} 4, 404.

\leavevmode\hypertarget{ref-Smit2013}{}%
Smit, A. J., Roberts, M., Anderson, R. J., Dufois, F., Dudley, S. F.,
Bornman, T. G., et al. (2013). A coastal seawater temperature dataset
for biogeographical studies: Large biases between in situ and
remotely-sensed data sets around the coast of south africa. \emph{PLoS
One} 8, e81944.

\end{document}
